$("#images-list .list").empty();
$("#images-list .nav").empty();
<% @images.each do |image| %>
  $("#images-list .list").append('<div id="gallery-item_<%= image.id %>" class="gallery-item"><a href=""><%= image_tag(image.url(:small)) %></a><a href="" class="item-title"><%= image.title %></a></div>');
  $("#gallery-item_<%= image.id %> a").click(function() { setImage('<%= image.id %>', '<%= image.title %>', '<%= image.url(:thumb) %>', '<%= image.url(:small) %>'); $("#images-list").dialog('close'); return false; });
<% end -%>

<% (@images.length..20).each do %>
  $("#images-list .list").append('<div class="gallery-item">&nbsp;</div>');
<% end if @images.length < 20 %>

if (!$("#images-list").parents(".ui-dialog").is(":visible"))
  $("#images-list").dialog({
    width: Math.min(820, 0.8 * $(window).width()),
    height: Math.min(600, 0.8 * $(window).height())
  });
